<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[thina]]></title>
  <link href="http://toshiyukihina.github.io/atom.xml" rel="self"/>
  <link href="http://toshiyukihina.github.io/"/>
  <updated>2014-12-30T00:58:18+09:00</updated>
  <id>http://toshiyukihina.github.io/</id>
  <author>
    <name><![CDATA[thina]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Sudoセッションで 'Bundle Exec' を実行する]]></title>
    <link href="http://toshiyukihina.github.io/blog/2014/05/05/using-rbenv-sudo/"/>
    <updated>2014-05-05T18:00:54+09:00</updated>
    <id>http://toshiyukihina.github.io/blog/2014/05/05/using-rbenv-sudo</id>
    <content type="html"><![CDATA[<p>sudoセッションでコマンドを実行するためには、<a href="https://github.com/dcarley/rbenv-sudo">rbenv-sudo</a>を使えばよい。</p>

<!-- more -->


<h2>事象</h2>

<p><a href="https://github.com/github/hub">hub</a>をLinux環境(Ubuntu 14.04 LTS)にインストールした際に、以下のエラーが出た。
<code>/usr/local/bin</code>にインストールするため、root権限が必要である。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bundle <span class="nb">exec </span>rake install
</span><span class='line'>rake aborted!
</span><span class='line'>Permission denied - /usr/local/bin/hub
</span><span class='line'>/home/hina/devel/github/hub/Rakefile:121:in <span class="sb">`</span>block in &lt;top <span class="o">(</span>required<span class="o">)</span>&gt;<span class="err">&#39;</span>
</span><span class='line'>Tasks: <span class="nv">TOP</span> <span class="o">=</span>&gt; install
</span><span class='line'><span class="o">(</span>See full trace by running task with --trace<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>解決方法</h2>

<h3>前提条件</h3>

<p>rbenvがインストールされていること。</p>

<ul>
<li>rbenv 0.4.0-97-gfe0b243</li>
</ul>


<h3>手順</h3>

<h4>rbenv-sudoをインストールする</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git clone git://github.com/dcarley/rbenv-sudo.git ~/.rbenv/plugins/rbenv-sudo
</span></code></pre></td></tr></table></div></figure>


<h4>hubをインストールする</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rbenv sudo bundle <span class="nb">exec </span>rake install
</span></code></pre></td></tr></table></div></figure>


<h4>hubがインストールできたか確認する</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>which hub
</span><span class='line'>/usr/local/bin/hub
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Creating a New Rails Project]]></title>
    <link href="http://toshiyukihina.github.io/blog/2014/05/04/creating-a-new-rails-project/"/>
    <updated>2014-05-04T14:02:37+09:00</updated>
    <id>http://toshiyukihina.github.io/blog/2014/05/04/creating-a-new-rails-project</id>
    <content type="html"><![CDATA[<p>How to create a rails new project without tainting the global rails environment.</p>

<!-- more -->


<h2>Environment</h2>

<h3>OS</h3>

<p>Linux ubuntu 3.13.0-24-generic #46-Ubuntu SMP Thu Apr 10 19:11:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</p>

<h3>Ruby</h3>

<p>1.9.3p545</p>

<h3>Ruby on Rails</h3>

<p>4.1.0</p>

<h3>rbenv</h3>

<p>rbenv 0.4.0-97-gfe0b243</p>

<h2>Prerequisite</h2>

<p>You must install <code>bundler</code> at least to your ruby environment.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rbenv <span class="nb">exec </span>gem install bundler
</span><span class='line'><span class="nv">$ </span>rbenv rehash
</span></code></pre></td></tr></table></div></figure>


<h2>Steps</h2>

<h3>Create a working directory</h3>

<p>Create a temporary directory for setup the rails environment. This enviroment will be deleted after committing and pushing to your repository.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>mkdir work
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>work
</span></code></pre></td></tr></table></div></figure>


<h3>Create a &lsquo;Gemfile&rsquo;</h3>

<p>Just only &lsquo;rails&rsquo; in the &lsquo;Gemfile&rsquo;.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>cat <span class="s">&lt;&lt; EOS &gt; Gemfile</span>
</span><span class='line'><span class="s">source &quot;http://rubygems.org&quot;</span>
</span><span class='line'><span class="s">gem &quot;rails&quot;, &quot;4.1.0&quot;</span>
</span><span class='line'><span class="s">EOS</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Install Ruby on Ralis</h3>

<p>Install the ruby on rails to <code>vendor/bundle</code> directory temporarily.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bundle install --path vendor/bundle
</span></code></pre></td></tr></table></div></figure>


<h3>Create a new rails project</h3>

<p><code>&lt;project&gt;</code> is a new rails project name.
<strong>Don&rsquo;t forget</strong> to set <code>--skip-bundle</code> option, or all gems will be installed global location.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bundle <span class="nb">exec </span>rails new &lt;project&gt; --skip-bundle
</span></code></pre></td></tr></table></div></figure>


<h3>Tidy some temporary files and directories</h3>

<p>Delete all unnecessary files and directories.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rm -f Gemfile
</span><span class='line'><span class="nv">$ </span>rm -f Gemfile.lock
</span><span class='line'><span class="nv">$ </span>rm -rf vendor/bundle/
</span></code></pre></td></tr></table></div></figure>


<h3>Setup the rails environment</h3>

<p>Install gems depend on the Ruby on Rails. A new and official &lsquo;Gemfile&rsquo; is created on <code>bundle exec rails new &lt;project&gt; --skip-bundle</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">cd</span> &lt;project&gt;
</span><span class='line'><span class="nv">$ </span>bundle install --path vendor/bundle
</span></code></pre></td></tr></table></div></figure>


<h3>Check if the rails server starts successfully</h3>

<p>Run <code>rails server</code> command and access to <code>http://localhost:3000</code> with your browser.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bundle <span class="nb">exec </span>rails s
</span></code></pre></td></tr></table></div></figure>


<h3>Update &lsquo;.gitignore&rsquo;</h3>

<p>Add <code>/vendor/bundle</code> to <code>.gitignore</code> file.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">&#39;/vendor/bundle&#39;</span> &gt;&gt; .gitignore
</span></code></pre></td></tr></table></div></figure>


<h3>Finally push a new project to your repository</h3>

<p><a href="https://github.com/">Github</a>? <a href="https://bitbucket.org/">Bitbucket</a>? Do what you want.</p>
]]></content>
  </entry>
  
</feed>
